{"id":"8accf198-f4a7-40da-b972-0482fbce0786","zed":"context","version":"0.4.0","text":"\n\n\nit seems the program initializes shopcomboMap at the wrong time since comboname string doesnt return a combo name how would i fix this \nshop.cpp\n#include \"shop.h\"\n#include \"globals.h\"\n#include \"raylib.h\"\n#include <iostream>\n#include <random>\n\nShop::Shop() : comboWindow(\"/Users/markbabin/CODE/raylib_projects/Simoncello/sprites/shop_combo_window.png\", 128, 106, 0),\n               back(\"/Users/markbabin/CODE/raylib_projects/Simoncello/sprites/backBTN.png\", 13, 13, 0)\n{\n\n\n     randomCombo = ReturnRandCombo(combos);\n     comboName = shopComboMap[randomCombo].name;\n\n\n\n}\nvoid PurchaseCombo(const std::string& comboKey){\n\n}\n\nvoid Shop::Run(){\n\n    BeginDrawing();\nstd::cout << comboName << std::endl;\n    comboWindow.Update();\n    back.Update();\n\n    comboWindow.Draw();\n    DrawText(comboName.c_str(), 155, 200, 16, BLACK);\n    back.Draw();\n\n    if (back.IsClicked()){\n        currentGameState = BATTLE_PHASE;\n    }\n\n    EndDrawing();\n\n\n\n}\nstd::string Shop::ReturnRandCombo(const std::vector<std::string>& combos){\n   std::random_device rd;\n   std::mt19937 gen(rd());\n   std::uniform_int_distribution<> dis(0, combos.size() - 1);\n\n   return combos[dis(gen)];\n}\ncombo.h\n#pragma once\n#include \"unordered_map\"\n#include <string>\n\nstruct ComboData{\n    std::string name;\n    int price;\n    float multiplier;\n    bool owned = false;\n};\nextern std::unordered_map<std::string, ComboData> shopComboMap;\n\nvoid InitializeCombos();\ncombo.cpp\n#include \"combo.h\"\n\nstd::unordered_map<std::string, ComboData> shopComboMap;\n\nvoid InitializeCombos(){\nshopComboMap = {\n    {\"02\", {\"knightsForm\", 10, 2.0, false}},\n    {\"01\", {\"guardiansForm\", 10, 2.0, false}},\n    {\"21\", {\"templarsForm\", 10, 2.0, false}},\n\n    // 2-Face Combos\n    {\"22\", {\"dualBlades\", 10, 2.0, false}},\n    {\"11\", {\"shieldWall\", 10, 2.0, false}},\n    {\"00\", {\"cavalryCharge\", 10, 2.0, false}},\n    {\"24\", {\"lancersStrike\", 10, 2.0, false}},\n    {\"41\", {\"pikeFormation\", 10, 2.0, false}},\n    {\"01\", {\"mountedGuard\", 10, 2.0, false}},\n    {\"02\", {\"cavalryStrike\", 10, 2.0, false}},\n    {\"21\", {\"warriorsDefense\", 10, 2.0, false}},\n\n    // 3-Face Combos\n    {\"222\", {\"bladeMastery\", 10, 2.0, false}},\n    {\"111\", {\"fortress\", 10, 2.0, false}},\n    {\"000\", {\"stampede\", 10, 2.0, false}},\n    {\"224\", {\"bladeStorm\", 10, 2.0, false}},\n    {\"110\", {\"fortifiedPosition\", 10, 2.0, false}},\n    {\"002\", {\"mountedSquadron\", 10, 2.0, false}},\n    {\"114\", {\"phalanx\", 10, 2.0, false}},\n    {\"024\", {\"knightsCharge\", 10, 2.0, false}},\n    {\"014\", {\"mountedDefense\", 10, 2.0, false}},\n    {\"214\", {\"battleFormation\", 10, 2.0, false}},\n    {\"012\", {\"royalGuard\", 10, 2.0, false}},\n\n    // 4-Face Combos\n    {\"2222\", {\"swordLegion\", 10, 2.0, false}},\n    {\"1111\", {\"shieldLegion\", 10, 2.0, false}},\n    {\"0000\", {\"cavalryLegion\", 10, 2.0, false}},\n    {\"2224\", {\"grandAssault\", 10, 2.0, false}},\n    {\"1110\", {\"grandDefense\", 10, 2.0, false}},\n    {\"0002\", {\"grandCavalry\", 10, 2.0, false}},\n    {\"2211\", {\"battleWall\", 10, 2.0, false}},\n    {\"0214\", {\"perfectStrike\", 10, 2.0, false}},\n    {\"0021\", {\"royalFormation\", 10, 2.0, false}},\n    {\"1104\", {\"castleDefense\", 10, 2.0, false}},\n    {\"2201\", {\"warParty\", 10, 2.0, false}}\n};\n}\n\nThe issue is likely because the `shopComboMap` isn't initialized before the Shop constructor tries to access it. You need to call `InitializeCombos()` before creating any Shop objects. Here are a few ways to fix this:\n\n1. Call `InitializeCombos()` in your main function before creating any Shop objects:\n\n```cpp\n// main.cpp\nint main() {\n    InitializeCombos();\n    Shop shop;\n    // rest of your code\n}\n```\n\n2. Or call `InitializeCombos()` at the start of the Shop constructor:\n\n```cpp\n// shop.cpp\nShop::Shop() : comboWindow(\"/Users/markbabin/CODE/raylib_projects/Simoncello/sprites/shop_combo_window.png\", 128, 106, 0),\n               back(\"/Users/markbabin/CODE/raylib_projects/Simoncello/sprites/backBTN.png\", 13, 13, 0)\n{\n    InitializeCombos();  // Initialize combos first\n    randomCombo = ReturnRandCombo(combos);\n    comboName = shopComboMap[randomCombo].name;\n}\n```\n\n3. Or use a static initialization in combo.cpp:\n\n```cpp\n// combo.cpp\nstd::unordered_map<std::string, ComboData> shopComboMap = {\n    {\"02\", {\"knightsForm\", 10, 2.0, false}},\n    // ... rest of your mappings ...\n};\n\n// Remove InitializeCombos() function as it's no longer needed\n```\n\nThe first approach is generally preferred as it makes the initialization more explicit and gives you more control over when it happens. The second approach works but might lead to multiple initializations if you create multiple Shop objects. The third approach works but might make it harder to modify the combos at runtime if needed.\n\nAlso, make sure that your `combos` vector (used in `ReturnRandCombo`) contains valid keys that exist in `shopComboMap`. If the random key doesn't exist in the map, you'll get undefined behavior when trying to access the name.\n#pragma once\n#include \"unordered_map\"\n#include <string>\n\nstruct ComboData{\n    std::string name;\n    int price;\n    float multiplier;\n    bool owned = false;\n};\nextern std::unordered_map<std::string, ComboData> shopComboMap;\n\nvoid InitializeCombos();\nyour suggestion didnt fix anything is there a problem in combo.h \nThe combo.h file looks correct in terms of its basic structure. However, let's make sure the issue isn't related to how the data is being accessed. Can you check a few things:\n\n1. First, verify that your combos vector is properly populated. Can you show where and how `combos` is defined?\n\n2. Add some debug output in your Shop constructor:\n\n```cpp\nShop::Shop() : comboWindow(...), back(...)\n{\n    InitializeCombos();\n    \n    // Debug prints\n    std::cout << \"Map size: \" << shopComboMap.size() << std::endl;\n    randomCombo = ReturnRandCombo(combos);\n    std::cout << \"Random combo selected: \" << randomCombo << std::endl;\n    \n    // Check if the key exists\n    if (shopComboMap.find(randomCombo) != shopComboMap.end()) {\n        comboName = shopComboMap[randomCombo].name;\n        std::cout << \"Found combo name: \" << comboName << std::endl;\n    } else {\n        std::cout << \"Key not found in map!\" << std::endl;\n    }\n}\n```\n\n3. Also, make sure `combos` is declared somewhere and contains the correct keys. It should contain strings that match the keys in your shopComboMap. For example:\n\n```cpp\n// This should be defined somewhere, possibly in globals.h or shop.h\nstd::vector<std::string> combos = {\n    \"02\", \"01\", \"21\", \"22\", \"11\", \"00\", // etc...\n};\n```\n\n4. Verify that `InitializeCombos()` is actually being called by adding a debug print:\n\n```cpp\nvoid InitializeCombos() {\n    std::cout << \"Initializing combos...\" << std::endl;\n    shopComboMap = {\n        {\"02\", {\"knightsForm\", 10, 2.0, false}},\n        // ... rest of your mappings ...\n    };\n    std::cout << \"Combos initialized. Map size: \" << shopComboMap.size() << std::endl;\n}\n```\n\nCan you add these debug statements and let me know what output you see? This will help identify exactly where the problem is occurring.\n\nAlso, make sure you're not accidentally initializing shopComboMap multiple times or clearing it somewhere else in your code.\n\nhow would i make a function that buys the player the combo and stores it in a vector of why","messages":[{"id":{"replica_id":0,"value":0},"start":0,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":181}}},{"id":{"replica_id":0,"value":40},"start":3173,"metadata":{"role":"assistant","status":"Done","timestamp":{"replica_id":0,"value":182}}},{"id":{"replica_id":0,"value":41},"start":4894,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":183}}},{"id":{"replica_id":0,"value":95},"start":5211,"metadata":{"role":"assistant","status":"Done","timestamp":{"replica_id":0,"value":184}}},{"id":{"replica_id":0,"value":96},"start":7125,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":185}}}],"summary":"Combo Map Initialization Timing Fix","slash_command_output_sections":[{"range":{"start":0,"end":1},"icon":"Library","label":"Default","metadata":null}]}